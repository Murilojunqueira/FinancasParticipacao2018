exp(x) %>%
round(0) %>%
"/"(1000) %>%
as.character %>%
paste0(" mil")
}
exp.f(10)
exp.f <- function(x) {
exp(x) %>%
"/"(1000) %>%
round(0) %>%
as.character %>%
paste0(" mil")
}
exp.f(10)
exp.f <- function(x) {
exp(x) %>%
"/"(1000) %>%
round(0) %>%
as.character %>%
paste0(" mil")
}
#plot in ggplot2
ggplot(data=plotdata, aes(x = population.log, y =mean, fill = Group)) +
theme_classic(base_size = 15) +
geom_line(aes(y =mean)) +
geom_line(aes(y =high), linetype="dashed", color=NA) +
geom_line(aes(y =low), linetype="dashed", color=NA) +
xlab("População (log)") +
ylab("Probabilidade de OP") +
scale_y_continuous(labels = scales::percent) +
scale_x_continuous(breaks=c(10,12,14,16),
labels=c(exp.f(10), exp.f(12), exp.f(14), exp.f(16))) +
geom_ribbon(aes(ymin=low, ymax=high), alpha=0.6) +
scale_fill_manual(values=c("red", "green", "blue"), name="") +
theme(legend.position="bottom", plot.title = element_text(hjust = 0.5),
plot.subtitle = element_text(hjust = 0.5))
?format
exp.f <- function(x) {
exp(x) %>%
"/"(1000) %>%
round(0) %>%
as.character %>%
format(big.mark = ".") %>%
paste0(" mil")
}
exp.f(10)
exp.f(14)
formatC(1000.64, format="f", big.mark=",", digits=1)
exp(x) %>%
"/"(1000) %>%
round(0) %>%
format(big.mark = ".") %>%
as.character %>%
paste0(" mil")
exp.f <- function(x) {
exp(x) %>%
"/"(1000) %>%
round(0) %>%
format(big.mark = ".") %>%
as.character %>%
paste0(" mil")
}
exp.f(14)
exp.f <- function(x) {
exp(x) %>%
"/"(1000) %>%
round(0) %>%
format(big.mark = ".") %>%
paste0(" mil")
}
exp.f(14)
exp.f <- function(x) {
exp(x) %>%
"/"(1000) %>%
round(0) %>%
format(big.mark = ".", decimal.mark = ",") %>%
paste0(" mil")
}
exp.f(14)
#plot in ggplot2
ggplot(data=plotdata, aes(x = population.log, y =mean, fill = Group)) +
theme_classic(base_size = 15) +
geom_line(aes(y =mean)) +
geom_line(aes(y =high), linetype="dashed", color=NA) +
geom_line(aes(y =low), linetype="dashed", color=NA) +
xlab("População (log)") +
ylab("Probabilidade de OP") +
scale_y_continuous(labels = scales::percent) +
scale_x_continuous(breaks=c(10,12,14,16),
labels=c(exp.f(10), exp.f(12), exp.f(14), exp.f(16))) +
geom_ribbon(aes(ymin=low, ymax=high), alpha=0.6) +
scale_fill_manual(values=c("red", "green", "blue"), name="") +
theme(legend.position="bottom", plot.title = element_text(hjust = 0.5),
plot.subtitle = element_text(hjust = 0.5))
exp.f(10:16)
#plot in ggplot2
ggplot(data=plotdata, aes(x = population.log, y =mean, fill = Group)) +
theme_classic(base_size = 15) +
geom_line(aes(y =mean)) +
geom_line(aes(y =high), linetype="dashed", color=NA) +
geom_line(aes(y =low), linetype="dashed", color=NA) +
xlab("População (log)") +
ylab("Probabilidade de OP") +
scale_y_continuous(labels = scales::percent) +
scale_x_continuous(breaks=c(10:16),
labels=c(exp.f(10:16))) +
geom_ribbon(aes(ymin=low, ymax=high), alpha=0.6) +
scale_fill_manual(values=c("red", "green", "blue"), name="") +
theme(legend.position="bottom", plot.title = element_text(hjust = 0.5),
plot.subtitle = element_text(hjust = 0.5))
unidade <- ifelse(exp(x)>1000, "milhões", "mil")
exp.f <- function(x) {
unidade <- ifelse(exp(x)>1000, "milhões", "mil")
exp(x) %>%
"/"(1000) %>%
round(0) %>%
format(big.mark = ".", decimal.mark = ",") %>%
paste(unidade)
}
exp.f(10:16)
exp.f <- function(x) {
unidade <- ifelse(exp(x)>1000000, "milhões", "mil")
exp(x) %>%
"/"(1000) %>%
round(0) %>%
format(big.mark = ".", decimal.mark = ",") %>%
paste(unidade)
}
exp.f(10:16)
exp.f <- function(x) {
unidade <- ifelse(exp(x)>1000000, "milhões", "mil")
divisao <- ifelse(exp(x)>1000000, 1000000, 1000)
exp(x) %>%
"/"(divisao) %>%
round(0) %>%
format(big.mark = ".", decimal.mark = ",") %>%
paste(unidade)
}
exp.f(10:16)
exp.f <- function(x) {
unidade <- ifelse(exp(x)>1000000, "milhões", "mil")
divisao <- ifelse(exp(x)>1000000, 1000000, 1000)
digitos <- ifelse(exp(x)>1000000, 1, 0)
exp(x) %>%
"/"(digitos) %>%
round(0) %>%
format(big.mark = ".", decimal.mark = ",") %>%
paste(unidade)
}
exp.f(10:16)
exp.f <- function(x) {
unidade <- ifelse(exp(x)>1000000, "milhões", "mil")
divisao <- ifelse(exp(x)>1000000, 1000000, 1000)
digitos <- ifelse(exp(x)>1000000, 1, 0)
exp(x) %>%
"/"(divisao) %>%
round(digitos) %>%
format(big.mark = ".", decimal.mark = ",") %>%
paste(unidade)
}
exp.f(10:16)
exp.f <- function(x) {
unidade <- ifelse(exp(x)>1000000, "milhões", "mil")
divisao <- ifelse(exp(x)>1000000, 1000000, 1000)
digitos <- ifelse(exp(x)>1000000, 1, 0)
exp(x) %>%
"/"(divisao) %>%
round(digitos) %>%
format(big.mark = ".", decimal.mark = ",") %>%
paste0(" ", unidade)
}
exp.f(10:16)
exp.f <- function(x) {
unidade <- ifelse(exp(x)>1000000, "milhões", "mil")
divisao <- ifelse(exp(x)>1000000, 1000000, 1000)
digitos <- ifelse(exp(x)>1000000, 1, 0)
exp(x) %>%
"/"(divisao) %>%
round(digitos) %>%
format(big.mark = ".", decimal.mark = ",") %>%
paste0(" ", unidade) %>%
trimws
}
exp.f(10:16)
exp.f <- function(x) {
unidade <- ifelse(exp(x)>1000000, "milhões", "mil")
divisao <- ifelse(exp(x)>1000000, 1000000, 1000)
digitos <- ifelse(exp(x)>1000000, 1, 0)
exp(x) %>%
"/"(divisao) %>%
round(digitos) %>%
format(big.mark = ".", decimal.mark = ",") %>%
paste(unidade) %>%
trimws
}
exp.f(10:16)
#plot in ggplot2
ggplot(data=plotdata, aes(x = population.log, y =mean, fill = Group)) +
theme_classic(base_size = 15) +
geom_line(aes(y =mean)) +
geom_line(aes(y =high), linetype="dashed", color=NA) +
geom_line(aes(y =low), linetype="dashed", color=NA) +
xlab("População (log)") +
ylab("Probabilidade de OP") +
scale_y_continuous(labels = scales::percent) +
scale_x_continuous(breaks=c(10:16),
labels=c(exp.f(10:16))) +
geom_ribbon(aes(ymin=low, ymax=high), alpha=0.6) +
scale_fill_manual(values=c("red", "green", "blue"), name="") +
theme(legend.position="bottom", plot.title = element_text(hjust = 0.5),
plot.subtitle = element_text(hjust = 0.5))
#plot in ggplot2
ggplot(data=plotdata, aes(x = population.log, y =mean, fill = Group)) +
theme_classic(base_size = 15) +
geom_line(aes(y =mean)) +
geom_line(aes(y =high), linetype="dashed", color=NA) +
geom_line(aes(y =low), linetype="dashed", color=NA) +
xlab("População (log)") +
ylab("Probabilidade de OP") +
scale_y_continuous(labels = scales::percent) +
scale_x_continuous(breaks=c(10:16),
labels=c(exp.f(10:16))) +
geom_ribbon(aes(ymin=low, ymax=high), alpha=0.6) +
scale_fill_manual(values=c("red", "green", "blue"), name="") +
theme(legend.position="bottom", plot.title = element_text(hjust = 0.5),
plot.subtitle = element_text(hjust = 0.5),
axis.text.x = element_text(angle = 45, hjust = 1))
x = 10
exp(x)
unidade <- ifelse(exp(x)>1000000, "milhões", "mil")
unidade
divisao <- ifelse(exp(x)>1000000, 1000000, 1000)
divisao
digitos <- ifelse(exp(x)>1000000, 1, 0)
digitos
exp(x) %>%
"/"(divisao) %>%
round(digitos) %>%
format(big.mark = ".", decimal.mark = ",") %>%
paste(unidade) %>%
trimws
exp.f(10:16)
x= 10:16
x
unidade <- ifelse(exp(x)>1000000, "milhões", "mil")
unidade
divisao <- ifelse(exp(x)>1000000, 1000000, 1000)
divisao
digitos <- ifelse(exp(x)>1000000, 1, 0)
digitos
exp(x) %>%
"/"(divisao) %>%
round(digitos) %>%
format(big.mark = ".", decimal.mark = ",") %>%
paste(unidade) %>%
trimws
x = 10
unidade <- ifelse(exp(x)>1000000, "milhões", "mil")
divisao <- ifelse(exp(x)>1000000, 1000000, 1000)
digitos <- ifelse(exp(x)>1000000, 1, 0)
exp(x) %>%
"/"(divisao) %>%
round(digitos) %>%
format(big.mark = ".", decimal.mark = ",") %>%
paste(unidade) %>%
trimws
?format
#plot in ggplot2
ggplot(data=plotdata, aes(x = population.log, y =mean, fill = Group)) +
theme_classic(base_size = 12) +
theme(legend.position="bottom", plot.title = element_text(hjust = 0.5),
plot.subtitle = element_text(hjust = 0.5))+
geom_line(aes(y =mean)) +
geom_line(aes(y =high), linetype="dashed", color=NA) +
geom_line(aes(y =low), linetype="dashed", color=NA) +
labs(title = "Probabilidade de adoção do OP em Prefeituras do PT",
subtitle = "Eleição do PT ao Governo Federal em interação com população",
#caption = "Fonte: Spada(2012)/ TSE/ IBGE",
x = "População (log)", y = "Adoção  de OP") +
# labs(title = "Probability of PB Adoption in PT Prefectures",
# subtitle = " Federal Government Election effects in interaction with Population",
# caption = "Source: Spada(2012)/ TSE/ IBGE",
# x = "Population (log)", y = "PB Adoption") +
scale_y_continuous(labels = scales::percent) +
scale_x_continuous(breaks=c(10:16), labels=c(exp.f(10:16))) +
geom_ribbon(aes(ymin=low, ymax=high), alpha=0.5) +
scale_fill_manual(values=c("#ba2121", "#ffc3a0"), name = "Período")
# Quantities of interest
PT.Antes2002 <- setx(Zelig.pb.Min, population.log = seq(10, 16, by=0.5), ptwin = 1, LeftParty = 1, VictoryPTAfter2002 = 0)
PT.Depois2002 <- setx(Zelig.pb.Min, population.log = seq(10, 16, by=0.5), ptwin = 1, LeftParty = 1, VictoryPTAfter2002 = 1)
# Zelig Graph
s.out <- sim(Zelig.pb.Min, x = PT.Antes2002, x1 = PT.Depois2002)
ci.plot(s.out, var = "population.log", ci = 90, leg = 0,
xlab = "Population (log)",
ylab = "PB adoption probability")
#Same data in in ggplot2
qi.Values <- list(PT.Antes2002, PT.Depois2002)
plotdata <- Graph.Data(qi.Values, Zelig.pb.Min, "population.log", ci = 90)
# levels(plotdata$Group) <- c("Before 2002", "After 2002")
levels(plotdata$Group) <- c("Antes de 2002", "Depois de 2002")
#plot in ggplot2
ggplot(data=plotdata, aes(x = population.log, y =mean, fill = Group)) +
theme_classic(base_size = 12) +
geom_line(aes(y =mean)) +
geom_line(aes(y =high), linetype="dashed", color=NA) +
geom_line(aes(y =low), linetype="dashed", color=NA) +
labs(title = "Probabilidade de adoção do OP em Prefeituras do PT",
subtitle = "Eleição do PT ao Governo Federal em interação com população",
#caption = "Fonte: Spada(2012)/ TSE/ IBGE",
x = "População (log)", y = "Adoção  de OP") +
# labs(title = "Probability of PB Adoption in PT Prefectures",
# subtitle = " Federal Government Election effects in interaction with Population",
# caption = "Source: Spada(2012)/ TSE/ IBGE",
# x = "Population (log)", y = "PB Adoption") +
scale_y_continuous(labels = scales::percent) +
scale_x_continuous(breaks=c(10:16), labels=c(exp.f(10:16))) +
geom_ribbon(aes(ymin=low, ymax=high), alpha=0.5) +
scale_fill_manual(values=c("#ba2121", "#ffc3a0"), name = "Período") +
theme(legend.position="bottom", plot.title = element_text(hjust = 0.5),
plot.subtitle = element_text(hjust = 0.5),
axis.text.x = element_text(angle = 45, hjust = 1))
# Free memory
rm(PT.Depois2002, PT.Antes2002)
rm(plotdata, s.out, qi.Values)
#plot in ggplot2
ggplot(data=plotdata, aes(x = population.log, y =mean, fill = Group)) +
theme_classic(base_size = 14) +
geom_line(aes(y =mean)) +
geom_line(aes(y =high), linetype="dashed", color=NA) +
geom_line(aes(y =low), linetype="dashed", color=NA) +
labs(title = "Probabilidade de adoção do OP em Prefeituras do PT",
subtitle = "Eleição do PT ao Governo Federal em interação com população",
#caption = "Fonte: Spada(2012)/ TSE/ IBGE",
x = "População (log)", y = "Adoção  de OP") +
# labs(title = "Probability of PB Adoption in PT Prefectures",
# subtitle = " Federal Government Election effects in interaction with Population",
# caption = "Source: Spada(2012)/ TSE/ IBGE",
# x = "Population (log)", y = "PB Adoption") +
scale_y_continuous(labels = scales::percent) +
scale_x_continuous(breaks=c(10:16), labels=c(exp.f(10:16))) +
geom_ribbon(aes(ymin=low, ymax=high), alpha=0.5) +
scale_fill_manual(values=c("#ba2121", "#ffc3a0"), name = "Período") +
theme(legend.position="bottom",
plot.title = element_text(hjust = 0.5),
plot.subtitle = element_text(hjust = 0.5),
axis.text.x = element_text(angle = 45, hjust = 1))
# Quantities of interest
PT.Antes2002 <- setx(Zelig.pb.Min, population.log = seq(10, 16, by=0.5), ptwin = 1, LeftParty = 1, VictoryPTAfter2002 = 0)
PT.Depois2002 <- setx(Zelig.pb.Min, population.log = seq(10, 16, by=0.5), ptwin = 1, LeftParty = 1, VictoryPTAfter2002 = 1)
# Zelig Graph
s.out <- sim(Zelig.pb.Min, x = PT.Antes2002, x1 = PT.Depois2002)
ci.plot(s.out, var = "population.log", ci = 90, leg = 0,
xlab = "Population (log)",
ylab = "PB adoption probability")
#Same data in in ggplot2
qi.Values <- list(PT.Antes2002, PT.Depois2002)
plotdata <- Graph.Data(qi.Values, Zelig.pb.Min, "population.log", ci = 90)
# levels(plotdata$Group) <- c("Before 2002", "After 2002")
levels(plotdata$Group) <- c("Antes de 2002", "Depois de 2002")
#plot in ggplot2
ggplot(data=plotdata, aes(x = population.log, y =mean, fill = Group)) +
theme_classic(base_size = 14) +
geom_line(aes(y =mean)) +
geom_line(aes(y =high), linetype="dashed", color=NA) +
geom_line(aes(y =low), linetype="dashed", color=NA) +
labs(title = "Probabilidade de adoção do OP em Prefeituras do PT",
subtitle = "Eleição do PT ao Governo Federal em interação com população",
#caption = "Fonte: Spada(2012)/ TSE/ IBGE",
x = "População (log)", y = "Adoção  de OP") +
# labs(title = "Probability of PB Adoption in PT Prefectures",
# subtitle = " Federal Government Election effects in interaction with Population",
# caption = "Source: Spada(2012)/ TSE/ IBGE",
# x = "Population (log)", y = "PB Adoption") +
scale_y_continuous(labels = scales::percent) +
scale_x_continuous(breaks=c(10:16), labels=c(exp.f(10:16))) +
geom_ribbon(aes(ymin=low, ymax=high), alpha=0.5) +
scale_fill_manual(values=c("#ba2121", "#ffc3a0"), name = "Período") +
theme(legend.position="bottom",
plot.title = element_text(hjust = 0.5),
plot.subtitle = element_text(hjust = 0.5),
axis.text.x = element_text(angle = 45, hjust = 1))
#plot in ggplot2
ggplot(data=plotdata, aes(x = InvestPer, y =mean, fill = Group)) +
theme_classic(base_size = 14) +
theme(legend.position="bottom", plot.title = element_text(hjust = 0.5),
plot.subtitle = element_text(hjust = 0.5)) +
geom_line(aes(y =mean)) +
geom_line(aes(y =high), linetype="dashed", color=NA) +
geom_line(aes(y =low), linetype="dashed", color=NA) +
#labs(title = "Probabilidade da adoção/continuidade do OP",
#     subtitle = "Existência prévia de OP em interação com taxa de investimento")
#caption = "Source: Spada(2012)/ TSE/ IBGE",
labs(x = "Taxa de Investimento Municipal", y = "Adoção/Continuidade do OP") +
#labs(title = "Probability of PB Adoption",
#subtitle = "Previous PB existence effects in interaction with Investment rate",
#caption = "Source: Spada(2012)/ TSE/ IBGE",
#x = "Investment rate", y = "PB Adoption/Continuity") +
scale_y_continuous(labels = scales::percent) +
scale_x_continuous(labels = scales::percent) +
geom_ribbon(aes(ymin=low, ymax=high), alpha=0.5) +
# scale_fill_manual(values=c("light blue", "orange"), name="Previous Adminsitration:")
scale_fill_manual(values=c("light blue", "orange"), name="Administração prévia:")
# Quantities of interest
SemPB <- setx(Zelig.pb.Min, InvestPer = seq(0, 0.3, by=0.01), lag.pb = 0)
ComPB <- setx(Zelig.pb.Min, InvestPer = seq(0, 0.3, by=0.01), lag.pb = 1)
# Zelig Graph
s.out <- sim(Zelig.pb.Min, x = SemPB, x1 = ComPB)
# summary(s.out)
#english subtitles
ci.plot(s.out, var = "InvestPer", ci = 90, leg = 0,
# main = "Interaction Marginal Effects",
# xlab = "Local Investment (%)",
# ylab = "PB adoption/continuity")
xlab = "Investimento Municipal (%)",
ylab = "Chance de adotar o OP")
# Extract simulated data
qi.Values <- list(SemPB, ComPB)
plotdata <- Graph.Data(qi.Values, Zelig.pb.Min, "InvestPer", ci = 90)
#levels(plotdata$Group) <- c("No PB", "Adopts PB")
levels(plotdata$Group) <- c("Sem OP", "Com OP")
#plot in ggplot2
ggplot(data=plotdata, aes(x = InvestPer, y =mean, fill = Group)) +
theme_classic(base_size = 14) +
theme(legend.position="bottom", plot.title = element_text(hjust = 0.5),
plot.subtitle = element_text(hjust = 0.5)) +
geom_line(aes(y =mean)) +
geom_line(aes(y =high), linetype="dashed", color=NA) +
geom_line(aes(y =low), linetype="dashed", color=NA) +
#labs(title = "Probabilidade da adoção/continuidade do OP",
#     subtitle = "Existência prévia de OP em interação com taxa de investimento")
#caption = "Source: Spada(2012)/ TSE/ IBGE",
labs(x = "Taxa de Investimento Municipal", y = "Adoção/Continuidade do OP") +
#labs(title = "Probability of PB Adoption",
#subtitle = "Previous PB existence effects in interaction with Investment rate",
#caption = "Source: Spada(2012)/ TSE/ IBGE",
#x = "Investment rate", y = "PB Adoption/Continuity") +
scale_y_continuous(labels = scales::percent) +
scale_x_continuous(labels = scales::percent) +
geom_ribbon(aes(ymin=low, ymax=high), alpha=0.5) +
# scale_fill_manual(values=c("light blue", "orange"), name="Previous Adminsitration:")
scale_fill_manual(values=c("light blue", "orange"), name="Administração prévia:")
#levels(plotdata$Group) <- c("No PB", "Adopts PB")
levels(plotdata$Group) <- c("Sem OP  ", "Com OP")
#plot in ggplot2
ggplot(data=plotdata, aes(x = InvestPer, y =mean, fill = Group)) +
theme_classic(base_size = 14) +
theme(legend.position="bottom", plot.title = element_text(hjust = 0.5),
plot.subtitle = element_text(hjust = 0.5)) +
geom_line(aes(y =mean)) +
geom_line(aes(y =high), linetype="dashed", color=NA) +
geom_line(aes(y =low), linetype="dashed", color=NA) +
#labs(title = "Probabilidade da adoção/continuidade do OP",
#     subtitle = "Existência prévia de OP em interação com taxa de investimento")
#caption = "Source: Spada(2012)/ TSE/ IBGE",
labs(x = "Taxa de Investimento Municipal", y = "Adoção/Continuidade do OP") +
#labs(title = "Probability of PB Adoption",
#subtitle = "Previous PB existence effects in interaction with Investment rate",
#caption = "Source: Spada(2012)/ TSE/ IBGE",
#x = "Investment rate", y = "PB Adoption/Continuity") +
scale_y_continuous(labels = scales::percent) +
scale_x_continuous(labels = scales::percent) +
geom_ribbon(aes(ymin=low, ymax=high), alpha=0.5) +
# scale_fill_manual(values=c("light blue", "orange"), name="Previous Adminsitration:")
scale_fill_manual(values=c("light blue", "orange"), name="Administração prévia:")
# Quantities of interest
PT <- setx(Zelig.pb.Min, population.log = seq(10, 16, by=0.5), ptwin = 1, LeftParty = 1)
PT.Depois2002 <- setx(Zelig.pb.Min, population.log = seq(10, 16, by=0.5), ptwin = 1, LeftParty = 1, VictoryPTAfter2002 = 1)
PT.Antes2002 <- setx(Zelig.pb.Min, population.log = seq(10, 16, by=0.5), ptwin = 1, LeftParty = 1, VictoryPTAfter2002 = 0)
Esquerda <- setx(Zelig.pb.Min, population.log = seq(10, 16, by=0.5), ptwin = 0, LeftParty = 1, VictoryPTAfter2002 = 0)
CentroDireita <- setx(Zelig.pb.Min, population.log = seq(10, 16, by=0.5), ptwin = 0, LeftParty = 0, VictoryPTAfter2002 = 0)
# Zelig Graph
s.out <- sim(Zelig.pb.Min, x = PT, x1 = Esquerda)
ci.plot(s.out, var = "population.log", ci = 90, leg = 0)
# Extract simulated data
qi.Values <- list(PT, Esquerda, CentroDireita)
plotdata <- Graph.Data(qi.Values, Zelig.pb.Min, "population.log", ci = 90)
levels(plotdata$Group) <- c("PT   ", "Esquerda   ", "Centro Direita")
#plot in ggplot2
ggplot(data=plotdata, aes(x = population.log, y =mean, fill = Group)) +
theme_classic(base_size = 15) +
geom_line(aes(y =mean)) +
geom_line(aes(y =high), linetype="dashed", color=NA) +
geom_line(aes(y =low), linetype="dashed", color=NA) +
xlab("População (log)") +
ylab("Probabilidade de OP") +
scale_y_continuous(labels = scales::percent) +
scale_x_continuous(breaks=c(10:16), labels=c(exp.f(10:16))) +
geom_ribbon(aes(ymin=low, ymax=high), alpha=0.6) +
scale_fill_manual(values=c("red", "green", "blue"), name="") +
theme(legend.position="bottom", plot.title = element_text(hjust = 0.5),
plot.subtitle = element_text(hjust = 0.5),
axis.text.x = element_text(angle = 45, hjust = 1))
# Extract simulated data
qi.Values <- list(PT.Depois2002, Esquerda, CentroDireita)
plotdata <- Graph.Data(qi.Values, Zelig.pb.Min, "population.log", ci = 90)
levels(plotdata$Group) <- c("PT Depois de 2002    ", "Esquerda   ", "Centro Direita")
#plot in ggplot2
ggplot(data=plotdata, aes(x = population.log, y =mean, fill = Group)) +
theme_classic(base_size = 15) +
geom_line(aes(y =mean)) +
geom_line(aes(y =high), linetype="dashed", color=NA) +
geom_line(aes(y =low), linetype="dashed", color=NA) +
xlab("População (log)") +
ylab("Probabilidade de OP") +
scale_y_continuous(labels = scales::percent) +
scale_x_continuous(breaks=c(10:16), labels=c(exp.f(10:16))) +
geom_ribbon(aes(ymin=low, ymax=high), alpha=0.6) +
scale_fill_manual(values=c("red", "green", "blue"), name="") +
theme(legend.position="bottom", plot.title = element_text(hjust = 0.5),
plot.subtitle = element_text(hjust = 0.5),
axis.text.x = element_text(angle = 45, hjust = 1))
